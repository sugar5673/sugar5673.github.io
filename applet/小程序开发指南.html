<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>小程序开发指南 | Summer</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/logo.jpg">
    <link rel="manifest" href="/photo.jpg">
    <link rel="apple-touch-icon" href="/photo.jpg">
    <meta name="description" content="相关知识点的记录">
    
    <link rel="preload" href="/assets/css/0.styles.e4d8b86b.css" as="style"><link rel="preload" href="/assets/js/app.ee07517b.js" as="script"><link rel="preload" href="/assets/js/2.0c3a78b7.js" as="script"><link rel="preload" href="/assets/js/11.f4c28180.js" as="script"><link rel="prefetch" href="/assets/js/10.a0ad0d42.js"><link rel="prefetch" href="/assets/js/12.967ceb10.js"><link rel="prefetch" href="/assets/js/13.a7596775.js"><link rel="prefetch" href="/assets/js/14.10f1482c.js"><link rel="prefetch" href="/assets/js/15.4cab8f86.js"><link rel="prefetch" href="/assets/js/3.a923323b.js"><link rel="prefetch" href="/assets/js/4.68544723.js"><link rel="prefetch" href="/assets/js/5.97dcfa84.js"><link rel="prefetch" href="/assets/js/6.e83f9bee.js"><link rel="prefetch" href="/assets/js/7.16308ca4.js"><link rel="prefetch" href="/assets/js/8.ef73f663.js"><link rel="prefetch" href="/assets/js/9.53cf9c6c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e4d8b86b.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">Summer</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vue/vue基础知识.html" class="nav-link">
  VUE
</a></div><div class="nav-item"><a href="/applet/小程序基础知识了解.html" class="nav-link">
  小程序
</a></div><div class="nav-item"><a href="/markDown/" class="nav-link">
  markDown
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vue/vue基础知识.html" class="nav-link">
  VUE
</a></div><div class="nav-item"><a href="/applet/小程序基础知识了解.html" class="nav-link">
  小程序
</a></div><div class="nav-item"><a href="/markDown/" class="nav-link">
  markDown
</a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/applet/小程序设计规范.html" class="sidebar-link">小程序设计规范</a></li><li><a href="/applet/小程序重构规范.html" class="sidebar-link">小程序重构规范</a></li><li><a href="/applet/小程序基础知识了解.html" class="sidebar-link">小程序基础知识了解</a></li><li><a href="/applet/小程序开发指南.html" class="active sidebar-link">小程序开发指南</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/applet/小程序开发指南.html#小程序开发环境及起步" class="sidebar-link">小程序开发环境及起步</a></li><li class="sidebar-sub-header"><a href="/applet/小程序开发指南.html#小程序代码构成" class="sidebar-link">小程序代码构成</a></li><li class="sidebar-sub-header"><a href="/applet/小程序开发指南.html#小程序宿主环境" class="sidebar-link">小程序宿主环境</a></li><li class="sidebar-sub-header"><a href="/applet/小程序开发指南.html#组件" class="sidebar-link">组件</a></li><li class="sidebar-sub-header"><a href="/applet/小程序开发指南.html#api" class="sidebar-link">API</a></li><li class="sidebar-sub-header"><a href="/applet/小程序开发指南.html#事件" class="sidebar-link">事件</a></li><li class="sidebar-sub-header"><a href="/applet/小程序开发指南.html#小程序场景应用" class="sidebar-link">小程序场景应用</a></li><li class="sidebar-sub-header"><a href="/applet/小程序开发指南.html#本地数据缓存" class="sidebar-link">本地数据缓存</a></li><li class="sidebar-sub-header"><a href="/applet/小程序开发指南.html#小程序协同工作和发布" class="sidebar-link">小程序协同工作和发布</a></li><li class="sidebar-sub-header"><a href="/applet/小程序开发指南.html#小程序底层框架" class="sidebar-link">小程序底层框架</a></li><li class="sidebar-sub-header"><a href="/applet/小程序开发指南.html#小程序性能优化" class="sidebar-link">小程序性能优化</a></li></ul></li><li><a href="/applet/小程序开发中疑难杂症.html" class="sidebar-link">小程序开发中常见问题</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="小程序开发指南"><a href="#小程序开发指南" class="header-anchor">#</a> 小程序开发指南</h1> <h2 id="小程序开发环境及起步"><a href="#小程序开发环境及起步" class="header-anchor">#</a> 小程序开发环境及起步</h2> <ul><li>使用浏览器打开 <a href="https://mp.weixin.qq.com/" target="_blank" rel="noopener noreferrer">申请APPId<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> 点击立即注册，如图1-1所示，在打开的页面中选择小程序后，填入相关的信息，就可以完成注册了。</li> <li>安装开发者工具，<a href="https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html" target="_blank" rel="noopener noreferrer">软件地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h2 id="小程序代码构成"><a href="#小程序代码构成" class="header-anchor">#</a> 小程序代码构成</h2> <h3 id="一-wxml-后缀的wxml模板文件"><a href="#一-wxml-后缀的wxml模板文件" class="header-anchor">#</a> 一.wxml 后缀的WXML模板文件</h3> <ul><li>相当于网页中的HTML，WXML 由标签、属性等等构成。</li> <li>WXML要求标签必须是严格闭合的，没有闭合将会导致编译错误。</li> <li>WXML中的属性是大小写敏感的</li></ul> <div class="language-HTML line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>container<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userinfo<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name"><span class="token namespace">wx:</span>if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{!hasUserInfo &amp;&amp; canIUse}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> 获取头像昵称 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>else</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>image</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{userInfo.avatarUrl}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name">background-size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>cover<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>image</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>userinfo-nickname<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{userInfo.nickName}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>usermotto<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>user-motto<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{motto}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p><strong>HTML与WXML的区别</strong></p> <ul><li>标签名不一样
<blockquote><p>小程序的WXML用的标签是 view,button,text等。还提供了地图、视频、音频等组件能力</p></blockquote></li> <li>多了一些wx:if这样的属性及{{}}的表达式
<blockquote><p>在网页的一般开发流程中，我们通常会通过 JS 操作 DOM (对应 HTML 的描述产生的树)，以引起界面的一些变化响应用户的行为。例如，用户点击某个按钮的时候，JS 会记录一些状态到 JS 变量里边，同时通过 DOM API 操控 DOM 的属性或者行为，进而引起界面一些变化。当项目越来越大的时候，你的代码会充斥着非常多的界面交互逻辑和程序的各种状态变量，显然这不是一个很好的开发模式，因此就有了 MVVM 的开发模式（例如 React, Vue），提倡把渲染和逻辑分离。简单来说就是不要再让 JS 直接操控 DOM，JS 只需要管理状态即可，然后再通过一种模板语法来描述状态和界面结构的关系即可。</p></blockquote></li></ul> <img src="/mvvm.png"> <p>小程序的框架也是用到了这个思路，如果你需要把一个 Hello World 的字符串显示在界面上。</p> <p><strong>WXML 是这么写 :</strong></p> <div class="language-HTML line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{text}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>JS 只需要管理状态即可:</p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> msg<span class="token operator">:</span> <span class="token string">&quot;Hello World&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>通过  的语法把一个变量绑定到界面上，我们称为数据绑定。仅仅通过数据绑定还不够完整的描述状态和界面的关系，还需要 if/else, for等控制能力，在小程序里边，这些控制能力都用 wx: 开头的属性来表达。</p></blockquote> <h4 id="数据绑定"><a href="#数据绑定" class="header-anchor">#</a> 数据绑定</h4> <ul><li>WXML通过来绑定WXML文件和对应的JavaScript文件中的data对象属性。</li> <li>属性值必须被包裹再双引号中。</li> <li>变量名是大小写敏感的。即和是两个不同的变量</li> <li>没有被定义的变量或者是被设置为undefined的变量是不会被同步到wxml中</li></ul> <h4 id="逻辑语法"><a href="#逻辑语法" class="header-anchor">#</a> 逻辑语法</h4> <ul><li>通过语法可以使WXML拥有动态渲染的能力，还可以在{{}}内进行简单的逻辑运算</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">//三元运算</span>
<span class="token comment">// 根据a的值是否等于10 在页面输出不同的内容</span>
<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> a<span class="token operator">===</span><span class="token number">10</span><span class="token operator">?</span><span class="token string">&quot;变量a等于10&quot;</span><span class="token operator">:</span> <span class="token string">&quot;变量a不等于10&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span>


<span class="token comment">// 算数运算</span>
<span class="token comment">// {a:1, b:2, c:3}</span>

<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>a<span class="token operator">+</span>b<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">+</span> <span class="token punctuation">{</span><span class="token punctuation">{</span>c<span class="token punctuation">}</span><span class="token punctuation">}</span> <span class="token operator">+</span> d <span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span> <span class="token comment">//3+3+d</span>


<span class="token comment">//还支持字符串的拼接</span>
<span class="token comment">// {name: 'world'}</span>

<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token string">&quot;hello&quot;</span> <span class="token operator">+</span> name <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span> <span class="token comment">//输出hello world</span>

<span class="token comment">// 还可以放置数字、字符串或者数组</span>

<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span> <span class="token comment">//输出1，2，3</span>

<span class="token operator">&lt;</span>text<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token string">&quot;hello world&quot;</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>text<span class="token operator">&gt;</span> <span class="token comment">//输出hello world</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h4 id="条件逻辑"><a href="#条件逻辑" class="header-anchor">#</a> 条件逻辑</h4> <ul><li>WXML中，使用wx:if = &quot;&quot;来判断是否需要渲染该代码块</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;view wx:if=&quot;{{length &gt; 5}}&quot;&gt;1&lt;/view&gt;
&lt;view wx:elif=&quot;{{length &gt; 2}}&quot;&gt;2&lt;/view&gt;
&lt;view wx:else&gt;3&lt;/view&gt;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>因为wx:if是一个控制属性，需要将它添加到一个标签上。如果要一次性判断多个组件标签，可以使用一个<block></block>标签，将多个组件包装起来，并在上面使用wx:if控制属性</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>&lt;block wx:if=&quot;{{true}}&quot;&gt;
    &lt;view&gt;view1&lt;/view&gt;
    &lt;view&gt;view2&lt;/view&gt;
&lt;/block&gt;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="列表渲染"><a href="#列表渲染" class="header-anchor">#</a> 列表渲染</h4> <ul><li>在组件上使用wx:for控制属性绑定一个数组，即可使用数组中各项的数据重复渲染该组件。</li> <li>默认数组的当前项的下标变量名默认为index,数组当前项的变量名默认为item</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// array是一个数组</span>
<span class="token operator">&lt;</span>view wx<span class="token operator">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;{{array}}&quot;</span><span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">.</span>message<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>


<span class="token comment">// 对应的脚本文件</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token operator">:</span><span class="token punctuation">{</span>
        array<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">{</span>
            message<span class="token operator">:</span> <span class="token string">'foo'</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
            message<span class="token operator">:</span><span class="token string">'bar'</span>
        <span class="token punctuation">}</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>


<span class="token comment">//使用wx:for-item指定数组当前元素的变量名，使用wx:for-index指定数组当前下标的变量名</span>
<span class="token operator">&lt;</span>view wx<span class="token operator">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;{{array}}&quot;</span> wx<span class="token operator">:</span><span class="token keyword">for</span><span class="token operator">-</span>index <span class="token operator">=</span> <span class="token string">&quot;idx&quot;</span> wx<span class="token operator">:</span><span class="token keyword">for</span><span class="token operator">-</span>item<span class="token operator">=</span><span class="token string">&quot;itemName&quot;</span><span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">{</span>idx<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>itemName<span class="token punctuation">.</span>message<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">//类似block:if，也可以将wx:for用在&lt;block /&gt;标签上，以渲染一个包含多节点的结构块。如</span>
<span class="token operator">&lt;</span>block wx<span class="token operator">:</span><span class="token keyword">for</span><span class="token operator">=</span><span class="token string">&quot;{{[1,2,3]}}&quot;</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>index<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>item<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>block<span class="token operator">&gt;</span>


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><ul><li><p>如果列表中项目的位置会动态改变或者有新的项目添加到列表中，并且希望列表中的项目保持自己的特征和状态，需要使用wx:key来指定列表中项目的唯一的标识符</p></li> <li><p><strong>wx:key的值两种形式</strong></p></li> <li><p>1、字符串，代表在for循环的array中item的某个property，该property的值需要是列表中唯一的字符串或数组，且不能动态改变</p></li> <li><p>2、保留关键字this代表在for循环中的item本身，这种表示需要item本身是一个唯一的字符串或者数字。</p></li></ul> <p><strong>wx:key示例WXML</strong></p> <div class="language-HTML line-numbers-mode"><pre class="language-html"><code>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>switch</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{objectArray}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>unique<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span> {{item.id}} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>switch</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>switch<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> Switch <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>addToFront<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> Add to the front <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>


<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>switch</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{numberArray}}<span class="token punctuation">&quot;</span></span> <span class="token attr-name"><span class="token namespace">wx:</span>key</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>*this<span class="token punctuation">&quot;</span></span> <span class="token punctuation">&gt;</span></span> {{item}} <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>switch</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>addNumberToFront<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span> Add Number to the front <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>wx:key示例JavaScript</strong></p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span> <span class="token punctuation">{</span>
    objectArray<span class="token operator">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">'unique_5'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">'unique_4'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">'unique_3'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">'unique_2'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">'unique_1'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">{</span>id<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">'unique_0'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    numberArray<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">4</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">switch</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> length <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>objectArray<span class="token punctuation">.</span>length
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> <span class="token operator">++</span>i<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> x <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> length<span class="token punctuation">)</span>
      <span class="token keyword">const</span> y <span class="token operator">=</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>Math<span class="token punctuation">.</span><span class="token function">random</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> length<span class="token punctuation">)</span>
      <span class="token keyword">const</span> temp <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>objectArray<span class="token punctuation">[</span>x<span class="token punctuation">]</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>objectArray<span class="token punctuation">[</span>x<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>objectArray<span class="token punctuation">[</span>y<span class="token punctuation">]</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>objectArray<span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> temp
    <span class="token punctuation">}</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      objectArray<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>objectArray
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">addToFront</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> length <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>objectArray<span class="token punctuation">.</span>length
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>objectArray <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>id<span class="token operator">:</span> length<span class="token punctuation">,</span> unique<span class="token operator">:</span> <span class="token string">'unique_'</span> <span class="token operator">+</span> length<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>objectArray<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      objectArray<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>objectArray
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">addNumberToFront</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>numberArray <span class="token operator">=</span> <span class="token punctuation">[</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>numberArray<span class="token punctuation">.</span>length <span class="token operator">+</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>numberArray<span class="token punctuation">)</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      numberArray<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span>numberArray
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br></div></div><h4 id="模板"><a href="#模板" class="header-anchor">#</a> 模板</h4> <ul><li>WXML提供模板 template,可以在模板中定义代码片段，然后在不同的地方调用。使用name属性，作为模板的名字，然后在 内定义代码片段</li></ul> <div class="language-HTML line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msgItem<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{index}}:{{msg}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>Time: {{time}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

//使用js属性，声明需要的使用的模板，然后将模板所需要的data传入

<span class="token comment">&lt;!--
    item:{
        index:0,
        msg:'this is a template',
        time:'2016-06-18
    }
--&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>msgItem<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{...item}}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token comment">&lt;!-- 输出 
    0：this is a template Time:2016-06-18
--&gt;</span>


//JS可以动态决定具体需要渲染哪个模板

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>odd<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>odd<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>even<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>even<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>block</span> <span class="token attr-name"><span class="token namespace">wx:</span>for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{[1,2,3,4,5]}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>{{item % 2 === 0 ? <span class="token punctuation">'</span>even<span class="token punctuation">'</span> : <span class="token punctuation">'</span>odd<span class="token punctuation">'</span>}}<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>block</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 输出
    odd
    even
    odd
    even
    odd
--&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br></div></div><h4 id="引用"><a href="#引用" class="header-anchor">#</a> 引用</h4> <ul><li>WXML提供两种文件引用方式 <strong>import 和 include</strong></li> <li>import 可以在该文件中使用目标文件定义的template,如</li></ul> <div class="language-HTML line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- item.wxml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>text</span><span class="token punctuation">&gt;</span></span>{{text}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>text</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>template</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 在index.wxml中引用了item.wxml，就可以使用item模板 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>import</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item.wxml<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>template</span> <span class="token attr-name">is</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>item<span class="token punctuation">&quot;</span></span> <span class="token attr-name">data</span> <span class="token attr-value"><span class="token punctuation attr-equals">=</span> <span class="token punctuation">&quot;</span>{{text: <span class="token punctuation">'</span>forbar<span class="token punctuation">'</span>}}<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

//注意：import是有作用域的，只会import目标文件中定义的template，而不会import目标文件中import的template，简言之就是import不具有递归的特性。
//如，C引用了B，B引用了A，在C中可以使用B定义的template，在B中可以使用A定义的template，但是C不能使用A定义的template。

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><ul><li>include可以将目标文件中除了 <wxs></wxs>外的整个代码引入，相当于是拷贝到include位置。如</li></ul> <div class="language-HTML line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- index.wxml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>header.wxml<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>body<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>include</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>footer.wxml<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>


<span class="token comment">&lt;!-- header.wxml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>header<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- footer.wxml --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>footer<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h3 id="二-wxss-后缀的-wxss-样式文件"><a href="#二-wxss-后缀的-wxss-样式文件" class="header-anchor">#</a> 二.wxss 后缀的 WXSS 样式文件</h3> <ul><li>WXSS 具有 CSS 大部分的特性</li></ul> <p><strong>WXSS扩展和新增</strong></p> <ul><li>1、新增尺寸单位rpx。适配不同宽度的屏幕，开发起来更简单。WXSS在底层支持新的尺寸单位px。由于换算采用的是浮点数运算，所以运算结果和预期结果有一点点偏差.</li> <li>在一个宽度为375物理像素的屏幕下，1rpx = 1px</li> <li>2、提供全局样式和局部样式。和app.json，page.json概念相同，可以写一个app.wxss作为全局样式。</li> <li>3、WXSS仅支持部分CSS选择器。</li> <li>在CSS中，可以这样引用另一个样式文件 @import url('./test_0.css')，在小程序中有可以这样引用@import './test_0.wxss'。由于WXSS最终会被编译打包到目标文件中，用户只需要下载一次。</li></ul> <h4 id="内联样式"><a href="#内联样式" class="header-anchor">#</a> 内联样式</h4> <ul><li>WXSS内联样式与Web开发一致</li> <li>小程序支持动态更新内联样式</li></ul> <div class="language-HTML line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- index.wxml --&gt;</span>
<span class="token comment">&lt;!-- 可动态变化的内联样式 --&gt;</span>
<span class="token comment">&lt;!-- 
    {
        eleColor: 'red',
        eleFontsize:'48rpx'
    }
 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span> <span class="token special-attr"><span class="token attr-name">style</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token value css language-css"><span class="token selector">color:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>eleColor<span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token selector">;font-size:</span><span class="token punctuation">{</span><span class="token punctuation">{</span>eleFontsize<span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">&quot;</span></span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="选择器"><a href="#选择器" class="header-anchor">#</a> 选择器</h4> <ul><li>WXSS与CSS类似
<table><thead><tr><th>名称</th> <th>层级</th></tr></thead> <tbody><tr><td>!important</td> <td>~</td></tr> <tr><td>style=&quot;&quot;</td> <td>1000</td></tr> <tr><td>#id</td> <td>100</td></tr> <tr><td>.class</td> <td>10</td></tr> <tr><td>element</td> <td>1</td></tr></tbody></table></li></ul> <h4 id="官方样式库weui"><a href="#官方样式库weui" class="header-anchor">#</a> 官方样式库WeUI</h4> <ul><li><a href="https://github.com/Tencent/weui-wxss" target="_blank" rel="noopener noreferrer">参考文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="三-js-后缀的-js-脚本逻辑文件"><a href="#三-js-后缀的-js-脚本逻辑文件" class="header-anchor">#</a> 三.js 后缀的 JS 脚本逻辑文件</h3> <ul><li>小程序的主要开发语言是JavaScript，开发者使用JS开开发业务逻辑及调用小程序的API来完成业务需求。</li> <li>一个服务仅仅只有界面展示是不够的，还需要和用户做交互：响应用户的点击、获取用户的位置等等。在小程序里边，我们就通过编写 JS 脚本文件来处理用户的操作。如下面的例子：</li></ul> <div class="language-HTML line-numbers-mode"><pre class="language-html"><code>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>view</span><span class="token punctuation">&gt;</span></span>{{ msg }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>view</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">bindtap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>clickMe<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>点击我<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language-js line-numbers-mode"><pre class="language-js"><code>    <span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token function-variable function">clickMe</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> msg<span class="token operator">:</span><span class="token string">&quot;Hello World&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>更多的相应事件操作，<a href="https://developers.weixin.qq.com/miniprogram/dev/framework/view/wxml/event.html" target="_blank" rel="noopener noreferrer">可参考<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <blockquote><p>可以在 JS 中调用小程序提供的丰富的 API，利用这些 API 可以很方便的调起微信提供的能力，例如获取用户信息、本地存储、微信支付等。</p></blockquote> <h4 id="不同环境下的javascript"><a href="#不同环境下的javascript" class="header-anchor">#</a> 不同环境下的JavaScript</h4> <p><strong>浏览器中JavaScript 构成</strong></p> <ul><li>浏览器中的JavaScript 是由 ECMAScript 和 BOM（浏览器对象模型）以及 DOM（文档对象模型）组成的</li></ul> <p><strong>NodeJS中JavaScript 构成</strong></p> <ul><li>NodeJS中的JavaScript 是由 ECMAScript 和 NPM以及Native模块组成</li></ul> <p><strong>小程序中的JavaScript 构成</strong></p> <ul><li>小程序中的 JavaScript 是由ECMAScript 以及小程序框架和小程序 API 来实现的</li> <li>所以类似 JQuery、Zepto这种浏览器类库是无法在小程序中运行起来的，同样的缺少 Native 模块和NPM包管理的机制，小程序中无法加载原生库，也无法直接使用大部分的 NPM 包。</li></ul> <h4 id="小程序的执行环境"><a href="#小程序的执行环境" class="header-anchor">#</a> 小程序的执行环境</h4> <p><strong>小程序目前可以运行的三大平台：</strong></p> <ul><li>iOS平台，包括iOS9、iOS10、iOS11</li> <li>Android平台</li> <li>小程序IDE</li></ul> <p><strong>开发者需要在项目设置中，勾选ES6转ES5的功能。</strong> 设置-&gt;项目设置</p> <h4 id="模块化"><a href="#模块化" class="header-anchor">#</a> 模块化</h4> <ul><li>浏览器中，所有js是运行在同一个作用域下的</li> <li>小程序中，可以将任何一个js文件作为一个模块，通过module.exports或者exports对外暴露接口。</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">// moduleA.js</span>
module<span class="token punctuation">.</span><span class="token function-variable function">exports</span> <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">return</span> value <span class="token operator">*</span> <span class="token number">2</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">//B.js</span>
<span class="token comment">//在B.js中引用模块A</span>
<span class="token keyword">var</span> multiplyBy2 <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./moduleA'</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> result <span class="token operator">=</span> <span class="token function">multiplyBy2</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>


<span class="token comment">//在需要使用这些模块的文件中，使用require(path)将公共代码引入</span>
<span class="token keyword">var</span> common <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'common.js'</span><span class="token punctuation">)</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">helloMINA</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    common<span class="token punctuation">.</span><span class="token function">sayHello</span><span class="token punctuation">(</span><span class="token string">'MINA'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">goodbyeMINA</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    common<span class="token punctuation">.</span><span class="token function">sayGoodbye</span><span class="token punctuation">(</span><span class="token string">'MINA'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h4 id="脚本的执行顺序"><a href="#脚本的执行顺序" class="header-anchor">#</a> 脚本的执行顺序</h4> <ul><li>浏览器中，脚本严格按照加载的顺序执行</li> <li>小程序中，执行的入口文件是app.js,并且会根据其中require的模块顺序决定文件的运行顺序。</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">//app.json</span>
<span class="token punctuation">{</span>
  <span class="token string">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token string">&quot;pages/index/index&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;pages/log/log&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;pages/result/result&quot;</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token string">&quot;window&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span>


<span class="token comment">//app.js</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'app.js'</span><span class="token punctuation">)</span>

<span class="token comment">// pages/index/index</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'pages/index/index'</span><span class="token punctuation">)</span>

<span class="token comment">// pages/log/log</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'pages/log/log'</span><span class="token punctuation">)</span>

<span class="token comment">// pages/result/result</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'pages/result/result'</span><span class="token punctuation">)</span>


<span class="token comment">//以上文件执行后的结果为：</span>
app<span class="token punctuation">.</span>js
pages<span class="token operator">/</span>index<span class="token operator">/</span>index
pages<span class="token operator">/</span>log<span class="token operator">/</span>log
pages<span class="token operator">/</span>result<span class="token operator">/</span>result

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><h4 id="作用域"><a href="#作用域" class="header-anchor">#</a> 作用域</h4> <blockquote><p>在文件中声明的变量和函数只在该文件中有效，不同的文件中可以声明相同名字的变量和函数，不会相互影响。
当需要使用全局变量时，通过使用全局函数getApp()获取全局的实例，并设置相关属性值，来达到设置全局变量的目的。</p></blockquote> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">//a.js</span>
<span class="token comment">//获取全局变量</span>
<span class="token keyword">var</span> global <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
global<span class="token punctuation">.</span>globalValue <span class="token operator">=</span> <span class="token string">'globalValue'</span>


<span class="token comment">//b.js 中访问a.js定义的全局变量</span>
<span class="token comment">//访问全局变量</span>
<span class="token keyword">var</span> global <span class="token operator">=</span> <span class="token function">getApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>global<span class="token punctuation">.</span>globalValue<span class="token punctuation">)</span> <span class="token comment">//输出 globalValue</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><ul><li>注意：上述示例只有在a.js比b.js先执行才有效。</li> <li>当需要保证全局的数据可以在任何文件中安全的被使用到，那么可以在App()中进行设置。</li></ul> <h2 id="小程序宿主环境"><a href="#小程序宿主环境" class="header-anchor">#</a> 小程序宿主环境</h2> <ul><li>微信客户端给小程序缩提供的环境为宿主环境。小程序借助宿主环境提供的能力，可以完成许多普通网页无法完成的功能。</li></ul> <h3 id="_1、渲染层和逻辑层"><a href="#_1、渲染层和逻辑层" class="header-anchor">#</a> 1、渲染层和逻辑层</h3> <ul><li>小程序的运行环境分为渲染层和逻辑层，其中WXML模板和WXSS样式工作在渲染层，JS脚本工作在逻辑层。</li> <li>小程序的渲染层和逻辑层分别由2个线程管理：渲染层的界面使用了WebView 进行渲染；逻辑层采用JsCore线程运行JS脚本。一个小程序存在多个界面，所以渲染层存在多个WebView线程，这两个线程的通信会经由微信客户端（下文中也会采用Native来代指微信客户端）做中转，逻辑层发送网络请求也经由Native转发，小程序的通信模型下图所示。
<img src="https://res.wx.qq.com/wxdoc/dist/assets/img/4-1.ad156d1c.png"></li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">//渲染层和数据相关</span>
<span class="token operator">&lt;</span>view<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> msg <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">//逻辑层负责产生、处理数据</span>
<span class="token comment">//逻辑层通过Page实例的 setData 方法传递数据到渲染层</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span> msg<span class="token operator">:</span><span class="token string">'Hello World'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="数据驱动"><a href="#数据驱动" class="header-anchor">#</a> 数据驱动</h4> <ul><li>什么是数据驱动？</li></ul> <blockquote><p>在开发UI界面过程中，程序需要维护很多变量状态，同时要操作对应的UI元素，随着界面越来越复杂，我们需要维护很多变量状态，同时要处理很多界面上的交互事件，整个程序变得越来越复杂。通常界面视图和变量状态是相关联的，如果有某种‘方法’可以让状态和视图绑定在一起（状态变更时，视图也能自动变更），那我们就可以省去手动修改视图的工作。</p></blockquote> <ul><li>数据驱动原理</li></ul> <blockquote><p>WXML可以先转成JS对象，然后再渲染出真正的DOM树。
通过setData修改数据，产生的js对象的节点就会发生变化，此时可以对比前后两个JS对象得到变化的部分，然后把这个差异应用到原来的DOM树上，从而达到更新UI的目的，这就是“数据驱动”的原理。</p></blockquote> <h3 id="_2、程序与页面"><a href="#_2、程序与页面" class="header-anchor">#</a> 2、程序与页面</h3> <h4 id="程序"><a href="#程序" class="header-anchor">#</a> 程序</h4> <ul><li>一个小程序是由多个“页面”组成的“程序”。“小程序”指的是产品层面的程序，而“程序”指的是代码层面的程序实例。</li> <li>App()构造器必须写在项目根目录的app.js里，App是单例对象，在其他JS脚本中可以使用宿主环境提供的getApp（）来获取程序实例。</li> <li>微信客户端在打开小程序之前，会把整个小程序的代码包下载到本地。</li> <li>紧接着通过app.json的pages字段就可以知道你当前小程序的所有页面路径</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token string">&quot;pages&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token string">&quot;pages/index/index&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;pages/logs/logs&quot;</span>
    <span class="token punctuation">]</span>
    <span class="token comment">//在pages字段的第一个页面就是这个小程序的首页</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><ul><li>小程序启动后，在app.js定义的App实例的 onLaunch 回调会被执行</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">//App构造器接受一个Object参数。</span>
<span class="token comment">//onLaunch/onShow/onHide 三个回调是App实例的生命周期函数</span>
<span class="token comment">//onError</span>
<span class="token function">App</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function-variable function">onLaunch</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//小程序启动之后 触发</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li><p>整个小程序只有一个App实例，是全部页面共享的。</p> <p><strong>App构造器的参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>onLaunch</td> <td>Function</td> <td>当小程序初始化完成时，会触发onLaunch（全局只触发一次）</td></tr> <tr><td>onShow</td> <td>Function</td> <td>当小程序启动时，或从后台进入前台显示，会触发onShow</td></tr> <tr><td>onHide</td> <td>Function</td> <td>当小程序从前台进入后台，会触发onHide</td></tr> <tr><td>onError</td> <td>Function</td> <td>当小程序发生脚本错误，或者API调用失败时，会触发onError并带上错误信息</td></tr> <tr><td>其他字段</td> <td>任意</td> <td>可以添加任意的函数或数据到Object参数中，在App实例回调用this可以访问</td></tr></tbody></table></li></ul> <p><strong>程序的生命周期和打开场景</strong></p> <blockquote><p>初次进入小程序，微信客户端初始化好宿主环境，同时从网络下载或者从本地缓存中拿到小程序的代码包，把它注入到宿主环境，初始化完毕后，微信客户端就会给App实例派发onLaunch事件，App构造器参数所定义的onLaunch方法会被调用</p></blockquote> <blockquote><p>进入小程序 后，用户可以点击右上角的关闭，或者按手机设备的Home键离开小程序，此时小程序并没有被直接销毁，我们把这种情况称为“小程序进入后台状态”,App构造器参数所定义的onHide方法会被调用。</p></blockquote> <blockquote><p>当再次回到微信或者再次打开小程序时，微信客户端会把’后台‘的小程序唤醒，这种情况称为“小程序进入前台状态“,App构造器参数所定义的onShow方法会被调用。</p></blockquote> <blockquote><p>App的生命周期是由微信客户端根据用户操作主动触发的。</p></blockquote> <ul><li><a href="https://mp.weixin.qq.com/debug/wxadoc/dev/framework/app-service/app.html" target="_blank" rel="noopener noreferrer">获取最新的场景值说明请查看官方文档<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><strong>微信端打开小程序的途径</strong></p> <ul><li>群聊会话打开</li> <li>小程序列表中打开</li> <li>微信扫一扫</li> <li>从另外一个小程序打开当前小程序等</li></ul> <p><strong>小程序页面怎么写</strong></p> <ul><li>如pages/logs/logs 下面包括了4种文件，微信客户端会先根据logs.json配置生成一个界面，顶部的颜色和文字你都可以再这个json文件里面定义好。紧接着客户端就会装载这个页面的WXML结构和WXSS样式。最后客户端会装载logs.js，可以看到logs.js的大体内容就是：</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    data<span class="token operator">:</span><span class="token punctuation">{</span> <span class="token comment">//参与页面渲染的数据</span>
        logs<span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">//页面渲染后，执行</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>Page是一个页面构造器，这个构造器就生成了一个页面。在生成页面的时候，小程序框架会把data数据和index.wxml一起渲染出最终的结构。</li> <li>在渲染完界面之后，页面实例就会收到一个 onLoad的回调，你可以再这个回调处理你的逻辑。</li></ul> <h4 id="页面"><a href="#页面" class="header-anchor">#</a> 页面</h4> <ul><li>一个小程序可以有很多页面，页面之间可以相互跳转</li></ul> <p><strong>文件构成和路径</strong></p> <blockquote><p>一个页面分为三部分组成：界面、配置和逻辑</p></blockquote> <ul><li>界面：由WXML和WXSS来负责描述</li> <li>配置：由JSON文件进行描述</li> <li>页面：由JS脚本文件负责</li></ul> <blockquote><p>一个页面的文件需要放置在同一个目录下，WXML和JS文件是必须存在的，JSON和WXSS文件是可选的</p></blockquote> <ul><li><p>页面路径需要再小程序代码根目录app.json中的pages字段声明。</p></li> <li><p>在app.json字段的代码路径需要去除.后缀。</p></li> <li><p>宿主环境提供了Page()构造器用来注册一个小程序页面，Page()在页面脚本page.js中调用。</p></li> <li><p>Page构造器接受一个Object参数，其中data属性是当前页面WXML模板中可以用来做数据绑定的初始数据。</p> <p><strong>Page构造器的参数</strong></p> <table><thead><tr><th>名称</th> <th>类型</th> <th>描述</th></tr></thead> <tbody><tr><td>data</td> <td>Object</td> <td>页面的初始数据</td></tr> <tr><td>onLoad</td> <td>Function</td> <td>生命周期函数--监听页面加载，触发时机早于onShow和onReady</td></tr> <tr><td>onReady</td> <td>Function</td> <td>生命周期函数--监听页面初次渲染完成</td></tr> <tr><td>onShow</td> <td>Function</td> <td>生命周期函数--监听页面,触发事件早于onReady</td></tr> <tr><td>onHide</td> <td>Function</td> <td>生命周期函数--监听页面隐藏</td></tr> <tr><td>onUnload</td> <td>Function</td> <td>生命周期函数--监听页面卸载</td></tr> <tr><td>onPullDownRefresh</td> <td>Function</td> <td>页面相关事件处理函数--监听用户下拉动作</td></tr> <tr><td>onReachBottom</td> <td>Function</td> <td>页面上拉触底事件的处理函数</td></tr> <tr><td>onShareAppMessage</td> <td>Function</td> <td>用户点击右上角转发</td></tr> <tr><td>onPageScroll</td> <td>Function</td> <td>页面滚动触发事件的处理函数</td></tr> <tr><td>其他</td> <td>Any</td> <td>可以添加任意的函数或数据，在Page实例的其他函数中用 this 可以访问</td></tr></tbody></table></li></ul> <p><strong>页面的生命周期</strong></p> <ul><li>Page的生命周期是由微信客户端根据用户操作主动触发的。</li> <li>案例：点击商品列表页的商品，到详情页</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 思路分析</span>
<span class="token comment">//点击跳转到详情页，把商品的id传递过来，详情页通过onLoad回调的</span>
<span class="token comment">//参数option就可以拿到商品id，从而绘制出对应的商品</span>

<span class="token comment">//pages/list/list.js</span>
<span class="token comment">//列表页使用navigateTo跳转详情页</span>
wx<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span> url<span class="token operator">:</span> <span class="token string">'pages/detail/detail?id=1&amp;other=abc'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//pages/detail/detail.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">option</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>option<span class="token punctuation">.</span>id<span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>option<span class="token punctuation">.</span>other<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p><strong>页面数据</strong></p> <ul><li>这里所说的数据其实就是来自于页面Page构造器的data字段，data参数是页面第一次渲染时从逻辑层传递到渲染层的数据。</li> <li>宿主环境所提供的Page实例的原型中有setData函数，我们可以再Page实例下的方法调用this.setData把数据传递给渲染层，从而达到更新界面的目的。</li> <li>由于小程序的渲染层和逻辑层分别在两个线程中运行，所以setData传递数据实际是一个异步的过程。所以setData的第二个参数是一个callback回调，在这次的setData对界面渲染完毕后触发。</li> <li>setData一般调用格式 setData(data, callback),其中data是由多个key:value构成的Object对象。</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">//page.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      text<span class="token operator">:</span><span class="token string">'change data'</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token comment">//在这次setData对界面渲染完毕后触发</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><ul><li>实际开发的时候，页面的data数据会涉及相当多的字段，并不需要每次都将整个data字段重新设置一遍，只需要把改变的值进行设置即可，宿主环境会自动把新改动的字段合并到渲染层对应的字段中。</li> <li>只需要保持一个原则就可以提高小程序的渲染性能：每次只设置需要改变的最小单位数据。</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">//page.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span><span class="token punctuation">{</span>
    a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>b<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>c<span class="token operator">:</span><span class="token number">3</span><span class="token punctuation">,</span>
    d<span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token punctuation">{</span>text<span class="token operator">:</span><span class="token string">'hello'</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//a需要变化时，只需要setData设置a字段即可</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>a<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p><strong>注意</strong></p> <ul><li>1、直接修改Page实例的this.data而不调用this.setData是无法改变页面的状态的，还会造成数据不一致。</li> <li>2、由于setData是需要两个线程的一些通信消耗，为了提高性能，每次设置的数据不应超过1024kb</li> <li>3、不要把data中的任意一项的value设为undefined，否则可能会有引起一些不可预料的bug。</li></ul> <p><strong>页面的用户行为</strong></p> <ul><li>1、下拉刷新 onPullDownRefresh</li></ul> <blockquote><p>监听用户下拉刷新事件，需要在app.json的window选项中或者页面配置page.json中设置enablePullDownRefresh为true。当处理完数据刷新后，wx.stopPullDownRefresh可以停止当前页面的下来刷新。</p></blockquote> <ul><li>2、上拉触底 onReachBottom</li></ul> <blockquote><p>监听用户上拉触底事件。可以在app.json的window选项中或者页面配置page.json中设置触发距离onReachDistance.在触发距离内滑动期间，本事件只会被触发一次。</p></blockquote> <ul><li>3、页面滚动 onPageScroll</li></ul> <blockquote><p>监听用户滑动页面事件，参数为Object,包含scrollTop字段，表示页面在垂直方向已滚动的距离。（单位px）</p></blockquote> <ul><li>4、用户转发 onShareAppMessage</li></ul> <blockquote><p>只有定义了此事件处理函数，右上角才会显示“转发”按钮,在用户点击转发按钮的时候会调用，此事件需要return一个Object,包含title和path两个字段，用于自定义转发内容。</p></blockquote> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">//page.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onShareAppMessage</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      title<span class="token operator">:</span><span class="token string">'自定义转发标题'</span><span class="token punctuation">,</span>
      path<span class="token operator">:</span><span class="token string">'/page/user?id=123'</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>页面跳转和路由</strong></p> <ul><li>一个小程序拥有多个页面，我们可以通过wx.navigateTo推入一个新的页面，在首页使用2次wx.navigateTo后，页面层级会有三层，我们把这样的一个页面层级称为页面栈。</li> <li>小程序提供了原生的Tabbar支持，我们可以再app.json声明tabBar字段来定义Tabbar页</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token string">&quot;tabBar&quot;</span><span class="token operator">:</span><span class="token punctuation">{</span>
  <span class="token string">&quot;list&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span><span class="token string">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;Tab1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span><span class="token string">&quot;pageA&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;Tab1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span><span class="token string">&quot;pageB&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span><span class="token string">&quot;text&quot;</span><span class="token operator">:</span><span class="token string">&quot;Tab1&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;pagePath&quot;</span><span class="token operator">:</span><span class="token string">&quot;pageG&quot;</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>wx.navigateTo和wx.redirectTo只能打开非TabBar页面，wx.switchTab只能打开Tabbar页面。</strong></p> <p><strong>还可以使用wx.reLaunch({url:'pageH'})重启小程序，并且打开pageH,此时页面栈为[pageH].</strong></p> <p><strong>页面底部的 tabBar 由页面决定，即只要是定义为 tabBar 的页面，底部都有 tabBar。</strong></p> <h2 id="组件"><a href="#组件" class="header-anchor">#</a> 组件</h2> <ul><li>小程序里面，你只需要在WXML写上对应的组件标签名就可以把该组件显示再界面上。</li> <li>如需要在界面显示地图，只需要写上<map></map>即可。</li> <li>使用组件的时候，还可以通过属性传递值给组件，让组件可以以不同的状态去展现。</li> <li><strong>所有组件名和属性都是小写，多个单词会以英文横杠&quot;-&quot;进行连接</strong></li></ul> <div class="language-HTML line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!--地图一开始的中心的经纬度是广州，则需要声明
地图的longitude（中心经度）和latitude（中心纬度）两个属性--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>map</span> <span class="token attr-name">longitude</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>广州经度<span class="token punctuation">&quot;</span></span> <span class="token attr-name">latitude</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>广州纬度<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>map</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!-- 
    组件内部行为也会通过事件的形式让开发者可以感知。
    如用户点击了地图上的某个标记，你可以再js编写marktap函数处理：
 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>map</span> <span class="token attr-name">bindmarkertap</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>markertap<span class="token punctuation">&quot;</span></span> <span class="token attr-name">longitude</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>广州经度<span class="token punctuation">&quot;</span></span> <span class="token attr-name">latitude</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>广州纬度<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>map</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><p>也可以通过style或者class来控制组件的外层样式。更多组件参考<a href="https://developers.weixin.qq.com/miniprogram/dev/component/" target="_blank" rel="noopener noreferrer">小程序的组件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p><strong>基础内容</strong></p> <table><thead><tr><th>名称</th> <th>功能说明</th></tr></thead> <tbody><tr><td>icon</td> <td>图标组件</td></tr> <tr><td>progress</td> <td>进度条</td></tr> <tr><td>rich-text</td> <td>富文本</td></tr> <tr><td>text</td> <td>文本</td></tr></tbody></table> <p><strong>视图容器</strong></p> <table><thead><tr><th>名称</th> <th>功能说明</th></tr></thead> <tbody><tr><td>cover-image</td> <td>覆盖在原生组件之上的图片视图</td></tr> <tr><td>cover-view</td> <td>覆盖在原生组件之上的文本视图</td></tr> <tr><td>match-media</td> <td>media query 匹配检测节点</td></tr> <tr><td>movable-area</td> <td>movable-view的可移动区域</td></tr> <tr><td>movable-view</td> <td>可移动的视图容器，在页面中可以拖拽滑动</td></tr> <tr><td>page-container</td> <td>页面容器</td></tr> <tr><td>scroll-view</td> <td>可滚动视图区域</td></tr> <tr><td>share-element</td> <td>共享元素</td></tr> <tr><td>swiper</td> <td>滑块视图容器</td></tr> <tr><td>swiper-item</td> <td>仅可放置在swiper组件中，宽高自动设置为100%</td></tr> <tr><td>view</td> <td>视图容器</td></tr></tbody></table> <p><strong>表单组件</strong></p> <table><thead><tr><th>名称</th> <th>功能说明</th></tr></thead> <tbody><tr><td>button</td> <td>按钮</td></tr> <tr><td>checkbox</td> <td>多选项目</td></tr> <tr><td>checkbox-group</td> <td>多项选择器，内部由多个checkbox组成</td></tr> <tr><td>editor</td> <td>富文本编辑器，可以对图片、文字进行编辑</td></tr> <tr><td>form</td> <td>表单</td></tr> <tr><td>input</td> <td>输入框</td></tr> <tr><td>keyboard-accessory</td> <td>设置 input / textarea 聚焦时键盘上方 cover-view / cover-image 工具栏视图</td></tr> <tr><td>label</td> <td>用来改进表单组件的可用性</td></tr> <tr><td>picker</td> <td>从底部弹起的滚动选择器</td></tr> <tr><td>picker-view</td> <td>嵌入页面的滚动选择器</td></tr> <tr><td>picker-view-column</td> <td>滚动选择器子项</td></tr> <tr><td>radio</td> <td>单选项目</td></tr> <tr><td>radio-group</td> <td>单项选择器，内部由多个 radio 组成</td></tr> <tr><td>slider</td> <td>滑动选择器</td></tr> <tr><td>switch</td> <td>开关选择器</td></tr> <tr><td>textarea</td> <td>多行输入框</td></tr></tbody></table> <p><strong>导航</strong></p> <table><thead><tr><th>名称</th> <th>功能说明</th></tr></thead> <tbody><tr><td>functional-page-navigator</td> <td>仅在插件中有效，用于跳转到插件功能页</td></tr> <tr><td>navigator</td> <td>页面链接</td></tr></tbody></table> <p><strong>媒体组件</strong></p> <table><thead><tr><th>名称</th> <th>功能说明</th></tr></thead> <tbody><tr><td>audio</td> <td>音频</td></tr> <tr><td>camera</td> <td>系统相机</td></tr> <tr><td>image</td> <td>图片</td></tr> <tr><td>live-player</td> <td>实时音视频播放（v2.9.1 起支持同层渲染）</td></tr> <tr><td>live-pusher</td> <td>实时音视频录制（v2.9.1 起支持同层渲染）</td></tr> <tr><td>video</td> <td>视频（v2.4.0 起支持同层渲染）</td></tr> <tr><td>voip-room</td> <td>多人音视频对话</td></tr></tbody></table> <p><strong>画布</strong></p> <table><thead><tr><th>名称</th> <th>功能说明</th></tr></thead> <tbody><tr><td>canvas</td> <td>画布</td></tr></tbody></table> <p><strong>导航栏</strong></p> <table><thead><tr><th>名称</th> <th>功能说明</th></tr></thead> <tbody><tr><td>navigation-bar</td> <td>页面导航条配置节点，用于指定导航栏的一些属性</td></tr></tbody></table> <p><strong>页面属性配置节点</strong></p> <table><thead><tr><th>名称</th> <th>功能说明</th></tr></thead> <tbody><tr><td>page-meta</td> <td>页面属性配置节点，用于指定页面的一些属性、监听页面事件</td></tr></tbody></table> <p><strong>原生组件说明</strong></p> <table><thead><tr><th>名称</th> <th>功能说明</th></tr></thead> <tbody><tr><td>native-component</td> <td>小程序中的部分组件是由客户端创建的原生组件</td></tr></tbody></table> <p><strong>无障碍访问</strong></p> <table><thead><tr><th>名称</th> <th>功能说明</th></tr></thead> <tbody><tr><td>aria-component</td> <td>满足视障人士对于小程序的访问需求</td></tr></tbody></table> <p><strong>开放能力</strong></p> <table><thead><tr><th>名称</th> <th>功能说明</th></tr></thead> <tbody><tr><td>web-view</td> <td>承载网页的容器</td></tr> <tr><td>ad</td> <td>Banner 广告</td></tr> <tr><td>ad-custom</td> <td>原生模板 广告</td></tr> <tr><td>official-account</td> <td>公众号关注组件</td></tr> <tr><td>open-data</td> <td>用于展示微信开放的数据</td></tr></tbody></table></li></ul> <h2 id="api"><a href="#api" class="header-anchor">#</a> API</h2> <ul><li>为了让开发者可以很方便的调起微信提供的能力，如获取用户信息、微信支付等</li> <li><a href="https://developers.weixin.qq.com/miniprogram/dev/framework/app-service/api.html#API" target="_blank" rel="noopener noreferrer">更多API查看<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><strong>API约定</strong></p> <ul><li>1、wx.on* 开头的 API 是监听某个事件发生的API接口，接受一个 Callback 函数作为参数。当该事件触发时，会调用 Callback 函数。</li> <li>2、如未特殊约定，多数 API 接口为异步接口 ，都接受一个Object作为参数。</li> <li>3、API的Object参数一般由success、fail、complete三个回调来接收接口调用结果，示例代码如代码清单3-17所示，详细说明如表3-9所示。</li> <li>4、wx.get* 开头的API是获取宿主环境数据的接口。</li> <li>5、wx.set* 开头的API是写入数据到宿主环境的接口。</li></ul> <p><strong>获取用户的地理位置</strong></p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code>wx<span class="token punctuation">.</span><span class="token function">getLoacation</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    type<span class="token operator">:</span><span class="token string">'wgs84'</span><span class="token punctuation">;</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> latitude <span class="token operator">=</span> res<span class="token punctuation">.</span>latitude <span class="token comment">//纬度</span>
        <span class="token keyword">var</span> longitude <span class="token operator">=</span> res<span class="token punctuation">.</span>longitude <span class="token comment">//经度</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p><strong>微信扫一扫</strong></p> <div class="language-JS line-numbers-mode"><pre class="language-js"><code>wx<span class="token punctuation">.</span><span class="token function">scanCode</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
   <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
       console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span>
   <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><ul><li>需注意：多数API的回调都是异步，你需要处理好代码逻辑的异步问题。</li></ul> <blockquote><p>小程序API有以下几种类型：
<strong>事件监听API</strong></p></blockquote> <ul><li>约定：以on开头的API用来监听某个事件是否触发，如wx.onSocketOpen,wx.onCompassChange等</li> <li>这里API接受一个回调函数作为参数，当事件触发时会调用这个回调函数，并将相关数据以参数形式传入。</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code>wx<span class="token punctuation">.</span><span class="token function">onCompassChange</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>direction<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>同步API</strong></p> <ul><li>约定：以Sync结尾的API都是同步API，如wx.setStorageSync,wx.getSystemInfoSync等，此外，也有一些其他的同步API,如wx.createWorker，wx.getBackgroundAudioManager等。</li> <li>同步API执行结果可以通过函数 返回值直接获取，如果执行出错会抛出异常。</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">try</span><span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">setStorageSync</span><span class="token punctuation">(</span><span class="token string">'key'</span><span class="token punctuation">,</span><span class="token string">'value'</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token keyword">catch</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>异步API</strong></p> <ul><li><p>大部分API都是异步API，如wx.request,wx.login等。这类API接口通常都接受一个Object类型的参数，这个参数都支持按需指定以下字段来接收接口调用结果：</p> <p><strong>Object 参数说明</strong></p> <table><thead><tr><th>参数名</th> <th>类型</th> <th>必填</th> <th>说明</th></tr></thead> <tbody><tr><td>success</td> <td>function</td> <td>否</td> <td>接口调用成功的回调函数</td></tr> <tr><td>fail</td> <td>function</td> <td>否</td> <td>接口调用失败的回调函数</td></tr> <tr><td>complete</td> <td>function</td> <td>否</td> <td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr> <tr><td>其他</td> <td>Any</td> <td>-</td> <td>接口定义的其他参数</td></tr></tbody></table> <p><strong>回调函数的参数</strong></p> <table><thead><tr><th>属性</th> <th>类型</th> <th>说明</th></tr></thead> <tbody><tr><td>errMsg</td> <td>string</td> <td>错误信息，如果调用成功返回 ${apiName}:ok</td></tr> <tr><td>errCode</td> <td>number</td> <td>错误码，仅部分 API 支持，具体含义请参考对应 API 文档，成功时为 0。</td></tr> <tr><td>其他</td> <td>Any</td> <td>接口返回的其他数据</td></tr></tbody></table></li> <li><p>异步API的执行结果需要通过Object类型的参数中传入的对应回调函数获取。部分异步API也会有返回值，可以用来实现更丰富的功能。如wx.request,wx.connectSocket</p></li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code>wx<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>code<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><strong>异步API返回Promise</strong></p> <ul><li><p>基础库2.10.2版本起，异步API支持callback &amp; promise两种调用方式。当接口参数Object对象中不包含 success/fail/complete时将默认返回promise，否则仍按回调方式执行，无返回值</p> <p><strong>注意事项</strong></p> <ul><li>1.部分接口如 downloadFile, request, uploadFile, connectSocket, createCamera（小游戏）本身就有返回值， 它们的 promisify 需要开发者自行封装。</li> <li>2.当没有回调参数时，异步接口返回 promise。此时若函数调用失败进入 fail 逻辑， 会报错提示 Uncaught (in promise)，开发者可通过 catch 来进行捕获。</li> <li>3.wx.onUnhandledRejection 可以监听未处理的 Promise 拒绝事件。</li></ul></li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">//callback形式调用</span>
wx<span class="token punctuation">.</span><span class="token function">chooseImage</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res:'</span><span class="token punctuation">,</span>res<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//promise 形式调用</span>
wx<span class="token punctuation">.</span><span class="token function">chooseImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token parameter">res</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'res'</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>云开发API</strong></p> <ul><li>在小程序端直接调用服务端的云函数</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code>wx<span class="token punctuation">.</span>cloud<span class="token punctuation">.</span><span class="token function">callFunction</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">//云函数名称</span>
    name<span class="token operator">:</span><span class="token string">'cloudFunc'</span><span class="token punctuation">;</span>
    <span class="token comment">//传给云函数的参数</span>
    data<span class="token operator">:</span><span class="token punctuation">{</span>
        a<span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span>
        b<span class="token operator">:</span><span class="token number">2</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>result<span class="token punctuation">)</span> <span class="token comment">//示例</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    fail<span class="token operator">:</span>console<span class="token punctuation">.</span>error
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//云函数同样支持promise形式调用</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">//wx.request发起网络请求</span>
wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span><span class="token string">'test.php'</span><span class="token punctuation">,</span>
  data<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  header<span class="token operator">:</span> <span class="token punctuation">{</span><span class="token string">'content-type'</span><span class="token operator">:</span><span class="token string">'application/json'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//收到https服务成功后返回</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">fail</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//发生网络错误等情况触发</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">complete</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//成功或者失败后触发</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><ul><li>API调用大多都是异步的。</li></ul> <h2 id="事件"><a href="#事件" class="header-anchor">#</a> 事件</h2> <ul><li>UI界面的程序需要和用户互动。如点击某个按钮，或长按某个需求。</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">// page.wxml</span>
<span class="token operator">&lt;</span>view id<span class="token operator">=</span><span class="token string">&quot;tapTest&quot;</span> data<span class="token operator">-</span>hi<span class="token operator">=</span><span class="token string">&quot;WeChat&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;tapName&quot;</span><span class="token operator">&gt;</span>Click me<span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>view<span class="token operator">&gt;</span>

<span class="token comment">// page.js</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">tapName</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p><strong>常见的事件类型</strong></p> <table><thead><tr><th>类型</th> <th>触发条件</th></tr></thead> <tbody><tr><td>touchstart</td> <td>手指触摸动作开始</td></tr> <tr><td>touchmove</td> <td>手指触摸后移动</td></tr> <tr><td>touchcancel</td> <td>手指触摸动作被打断，如来电提醒，弹窗</td></tr> <tr><td>touchend</td> <td>手指触摸动作结束</td></tr> <tr><td>tap</td> <td>手指触摸后马上离开</td></tr> <tr><td>longpress</td> <td>手指触摸后，超过350ms再离开，如果指定了事件回调函数并触发了这个事件，tap事件将不被触发</td></tr> <tr><td>longtap</td> <td>手指触摸后，超过350ms再离开（推荐使用longpress事件代替）</td></tr> <tr><td>transitionend</td> <td>会在 WXSS transition 或 wx.createAnimation 动画结束后触发</td></tr> <tr><td>animationstart</td> <td>会在一个 WXSS animation 动画开始时触发</td></tr> <tr><td>animationiteration</td> <td>会在一个 WXSS animation 一次迭代结束时触发</td></tr> <tr><td>animationend</td> <td>会在一个 WXSS animation 动画完成时触发</td></tr></tbody></table> <p><strong>事件绑定与冒泡捕获</strong></p> <ul><li>bindtap、catchtouchstart</li> <li>具体细节内容等遇到了，再来更新</li></ul> <p><strong>兼容</strong></p> <ul><li>针对不同的手机进行程序上的兼容，可以使用wx.getSystemInfo或wx.getSystemInfoSync来获取手机相关信息，进行差异化的服务</li></ul> <div class="language- line-numbers-mode"><pre class="language-text"><code>wx.getSystemInfoSync()
/*
  {
    brand: &quot;iPhone&quot;,      // 手机品牌
    model: &quot;iPhone 6&quot;,    // 手机型号
    platform: &quot;ios&quot;,      // 客户端平台
    system: &quot;iOS 9.3.4&quot;,  // 操作系统版本
    version: &quot;6.5.23&quot;,    // 微信版本号
    SDKVersion: &quot;1.7.0&quot;,  // 小程序基础库版本
    language: &quot;zh_CN&quot;,    // 微信设置的语言
    pixelRatio: 2,        // 设备像素比
    screenWidth: 667,    // 屏幕宽度
    screenHeight: 375,     // 屏幕高度
    windowWidth: 667,    // 可使用窗口宽度
    windowHeight: 375,     // 可使用窗口高度
    fontSizeSetting: 16   // 用户字体大小设置
  }
 */
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li>通过判断API是否存在做兼容</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>wx<span class="token punctuation">.</span>openBluetoothAdapter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  wx<span class="token punctuation">.</span><span class="token function">openBluetoothAdapter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果希望用户在最新版本的客户端上体验您的小程序，可以这样子提示</span>
  wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    title<span class="token operator">:</span> <span class="token string">'提示'</span><span class="token punctuation">,</span>
    content<span class="token operator">:</span> <span class="token string">'当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。'</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h2 id="小程序场景应用"><a href="#小程序场景应用" class="header-anchor">#</a> 小程序场景应用</h2> <p><strong>开发流程</strong></p> <ul><li>查看交互图</li> <li>优先完成WXML+WXSS还原设计稿，把页面涉及到的元素和视觉细节先调试完成</li> <li>按照页面交互梳理出每个页面的data部分，填充WXML模板语法，完成js逻辑部分</li></ul> <p><strong>Flex布局</strong></p> <ul><li>提供更灵活的布局模型</li></ul> <div class="language-CSS line-numbers-mode"><pre class="language-css"><code><span class="token comment">/* 在不固定高度信息的例子中，我们只需要再容器中设置以下两个属性
即可实现内容不确定下的垂直居中 */</span>

<span class="token selector">.container</span><span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span>flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span>column<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span>center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><ul><li><a href="https://developers.weixin.qq.com/ebook?action=get_post_info&amp;docid=00080e799303986b0086e605f5680a" target="_blank" rel="noopener noreferrer">更多详细flex布局看这里<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <p><strong>界面交互反馈</strong></p> <ul><li>通过hover-class属性改变触摸时的样式</li></ul> <div class="language-CSS line-numbers-mode"><pre class="language-css"><code><span class="token selector">//page.wxss
.hover</span><span class="token punctuation">{</span>
  <span class="token property">background-color</span><span class="token punctuation">:</span>gray<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

&lt;button hover-class=<span class="token string">&quot;hover&quot;</span>&gt;点击button&lt;/button&gt;
&lt;view hover-class=<span class="token string">&quot;hover&quot;</span>&gt; 点击view&lt;/view&gt;

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><ul><li>点击button按钮处理更消耗的操作时，也会使用button组件的loading属性</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">/* page.wxml */</span>
<span class="token operator">&lt;</span>button loading<span class="token operator">=</span><span class="token string">&quot;{{loading}}&quot;</span> bindtap<span class="token operator">=</span><span class="token string">&quot;tap&quot;</span><span class="token operator">&gt;</span>操作<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>

<span class="token comment">/* page.js */</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  data<span class="token operator">:</span><span class="token punctuation">{</span>
    loading<span class="token operator">:</span><span class="token boolean">false</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function-variable function">tap</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token comment">//把按钮的loading状态显示出来</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      loading<span class="token operator">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token comment">//接着做耗时的操作</span>


  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><ul><li>Toast 提示1.5秒后自动消失</li></ul> <div class="language-js line-numbers-mode"><pre class="language-js"><code><span class="token comment">// 显示、隐藏Toast</span>
<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">//显示Toast</span>
      title<span class="token operator">:</span><span class="token string">'已发送'</span><span class="token punctuation">,</span>
      icon<span class="token operator">:</span><span class="token string">'success'</span><span class="token punctuation">,</span>
      duration<span class="token operator">:</span><span class="token number">1500</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token comment">//wx.hideToast() //隐藏Toast</span>

  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>错误提示，会使用模态对话框来提示，同时附带下一步操作的指引。</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">onLoad</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    wx<span class="token punctuation">.</span><span class="token function">showModal</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      title<span class="token operator">:</span><span class="token string">'标题'</span><span class="token punctuation">,</span>
      content<span class="token operator">:</span><span class="token string">'告知当前状态，信息和解决方案'</span><span class="token punctuation">,</span>
      confirmText<span class="token operator">:</span><span class="token string">'主操作'</span><span class="token punctuation">,</span>
      cancelText<span class="token operator">:</span><span class="token string">'次要操作'</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>confirm<span class="token punctuation">)</span><span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'用户点击主操作'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>cancel<span class="token punctuation">)</span><span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'用户点击次要操作'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><ul><li>scroll-view可滚动视图组件</li> <li>可以通过组件的scroll-x和scroll-y属性决定滚动区域是否可以横向或者纵向滚动</li></ul> <h4 id="https网络通信"><a href="#https网络通信" class="header-anchor">#</a> HTTPS网络通信</h4> <ul><li>小程序经常需要往服务器传递数据或者从服务器拉取信息，这时可以使用wx.request这个API</li></ul> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">// wx.request 调用示例</span>
wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span><span class="token string">'https://test.com/getInfo'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span> <span class="token comment">//服务器回包信息</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><hr> <hr> <ul><li>小程序宿主环境要求request发起的网络请求必须是https协议请求，因此开发者服务器必须提供HTTPS服务的接口。</li> <li>为了保证小程序不乱用任意域名的服务，wx.request请求的域名需要在小程序管理平台进行配置。</li> <li>为了方便调试，开发者工具、小程序的开发版和小程序的体验版在某些情况下允许wx.request请求任意域名</li></ul> <hr> <hr> <p><strong>请求前后的状态处理</strong></p> <blockquote><p>场景：用户点击一个按钮，界面出现“加载中...”的loading界面，然后发送一个请求到后台，后台返回成功直接进入下一个业务逻辑处理，后台返回失败或者网络异常等情况，则显示一个“系统错误”Toast,，同时一开始的Loading界面会消失。</p></blockquote> <div class="language-JS line-numbers-mode"><pre class="language-js"><code><span class="token comment">// wx.request常见的实例代码</span>
<span class="token keyword">var</span> hasClick <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>

<span class="token function">Page</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function-variable function">tap</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>hasClick<span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    hasClick <span class="token operator">=</span> <span class="token boolean">true</span>
    wx<span class="token punctuation">.</span><span class="token function">showLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

    wx<span class="token punctuation">.</span><span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      url<span class="token operator">:</span><span class="token string">'https://test.com/getinfo'</span><span class="token punctuation">,</span>
      method<span class="token operator">:</span><span class="token string">'POST'</span><span class="token punctuation">,</span>
      header<span class="token operator">:</span><span class="token punctuation">{</span><span class="token string">'content-type'</span><span class="token operator">:</span><span class="token string">'application/json'</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      data<span class="token operator">:</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">success</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>statusCode <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>data<span class="token punctuation">)</span> <span class="token comment">//服务器回包内容</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">fail</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        wx<span class="token punctuation">.</span><span class="token function">showToast</span><span class="token punctuation">(</span><span class="token punctuation">{</span>title<span class="token operator">:</span><span class="token string">'系统错误'</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token function-variable function">complete</span><span class="token operator">:</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        wx<span class="token punctuation">.</span><span class="token function">hideLoading</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        hasClick <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token punctuation">}</span>
  
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">//为了防止用户极快速度触发两次tap回调，我们加了一个hasClick的“锁”</span>
<span class="token comment">//在开始请求前检查是否已经发起过请求，如果没有才发起，</span>
<span class="token comment">//等到请求返回之后再把锁的状态恢复回去</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p><strong>排查异常的方法</strong></p> <p>1.检查手机网络状态以及wifi连接点是否工作正常。</p> <p>2.检查小程序是否为开发版或者体验版，因为开发版和体验版的小程序不会校验域名。</p> <p>3.检查对应请求的HTTPS证书是否有效，同时TLS的版本必须支持1.2及以上版本，可以在开发者工具的console面板输入showRequestInfo()查看相关信息。</p> <p>4.域名不要使用IP地址或者localhost，并且不能带端口号，同时域名需要经过ICP备案。</p> <p>5.检查app.json配置的超时时间配置是否太短，超时时间太短会导致还没收到回报就触发fail回调。</p> <p>6.检查发出去的请求是否302到其他域名的接口，这种302的情况会被视为请求别的域名接口导致无法发起请求。</p> <h2 id="本地数据缓存"><a href="#本地数据缓存" class="header-anchor">#</a> 本地数据缓存</h2> <ul><li>每个小程序的缓存空间上线为10MB</li> <li>用户的关键信息数据应该放到服务器进行持久化存储</li></ul> <h2 id="小程序协同工作和发布"><a href="#小程序协同工作和发布" class="header-anchor">#</a> 小程序协同工作和发布</h2> <ul><li>体验版本</li> <li>一切以用户价值为依归</li></ul> <p><strong>小程序两种发布模式</strong></p> <ul><li>全量发布</li></ul> <blockquote><p>全量发布是指当点击发布之后，所有用户访问小程序时都会使用当前最新的发布版本。</p></blockquote> <ul><li>分阶段发布</li></ul> <blockquote><p>分阶段发布是指分不同时间段来控制部分用户使用最新的发布版本，分阶段发布我们也称为灰度发布。</p></blockquote> <h2 id="小程序底层框架"><a href="#小程序底层框架" class="header-anchor">#</a> 小程序底层框架</h2> <ul><li>原生组件的层级会比所有在WebView层渲染的普通组件要高。</li></ul> <p><strong>引入原生组件主要有3个好处：</strong></p> <ul><li>1.扩展Web的能力。比如像输入框组件（input, textarea）有更好地控制键盘的能力。</li> <li>2.体验更好，同时也减轻WebView的渲染工作。比如像地图组件（map）这类较复杂的组件，其渲染工作不占用WebView线程，而交给更高效的客户端原生处理。</li> <li>3.绕过setData、数据通信和重渲染流程，使渲染性能更好。比如像画布组件（canvas）可直接用一套丰富的绘图接口进行绘制。</li></ul> <h2 id="小程序性能优化"><a href="#小程序性能优化" class="header-anchor">#</a> 小程序性能优化</h2> <ul><li>精简代码，去掉不必要的WXML结构和未使用的WXSS定义</li> <li>减少在代码包中直接嵌入的资源文件</li> <li>压缩图片，使用适当的图片格式</li> <li>若小程序比较复杂，优化后代码总量仍然比较大，可以采用分包加载的方式优化</li></ul> <div class="language-JSON line-numbers-mode"><pre class="language-json"><code><span class="token comment">// 使用分包时app.json示例</span>
<span class="token punctuation">{</span>
  <span class="token property">&quot;pages&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token string">&quot;pages/index&quot;</span><span class="token punctuation">,</span>
    <span class="token string">&quot;pages/logs&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token property">&quot;subPages&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
      <span class="token property">&quot;root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packageA&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;pages/cat&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;pages/dog&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
      <span class="token property">&quot;root&quot;</span><span class="token operator">:</span> <span class="token string">&quot;packageB&quot;</span><span class="token punctuation">,</span>
      <span class="token property">&quot;pages&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">&quot;pages/apple&quot;</span><span class="token punctuation">,</span>
        <span class="token string">&quot;pages/banana&quot;</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><ul><li>小程序启动时仅有一个页面层级，每次调用wx.navigateTo，都会创建一个新的页面层级</li> <li>wx.navigateBack会销毁一个页面层级</li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/applet/小程序基础知识了解.html" class="prev">
        小程序基础知识了解
      </a></span> <span class="next"><a href="/applet/小程序开发中疑难杂症.html">
        小程序开发中常见问题
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.ee07517b.js" defer></script><script src="/assets/js/2.0c3a78b7.js" defer></script><script src="/assets/js/11.f4c28180.js" defer></script>
  </body>
</html>
